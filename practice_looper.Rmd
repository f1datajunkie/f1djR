---
title: "F1 Practice Report Generator"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

rootdir = './reports'
outdir="practice"
dir.create(rootdir, showWarnings = FALSE)
dir.create(paste(rootdir, outdir, sep='/'), showWarnings = FALSE)


```


## Race meeting settings

```{r}
stub='aus'
year=2018
country='Australia'

```


## Report generation

The following function will render a report for a practice session.

```{r}
renderDoc = function() {
  basefile="practice_template.Rmd"
  rmarkdown::render(basefile,
                    params = list(psession = psession,
                                  stub=stub, outdir = outdir, rootdir=rootdir,
                                  year = year, country=country,
                                  laptimeFilePath = laptimeFilePath),
                    output_file = outfile 
                    )
}

```

```{r message=FALSE}
#For each practice, generate the report

output_files = c('* Practice')

for (psession in c(1,2,3)) {
  laptimeFilePath=paste0("~/Dropbox/various/",stub,"18_p",psession,"laptimes.csv")
  outfile = paste0(rootdir,'/',outdir,'/practice_report_p', psession, '.md')
  renderDoc()
   
  output_files = c(output_files, paste0('\n\t* [FP',psession, '](', outdir, '/',
                                       outfile, ')' ))
}

writeLines(output_files, "SUMMARY_practice.md")
```

